<html>

    <head>
        <title> City Weather</title>
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    </head>

    <body>

        <form>
            Enter a Utah City: <input type="text" id="cityfield" value=""><br>
            Suggestions: <span id="txtHint"> Empty</span>
            <br>
            <input id="button" type="submit" value="Submit">
        </form>

        <br>
        City
        <br>
        
        <textarea id="dispcity"> No City</textarea>
        
        <div id="weather"> No Weather </div>

        <script> 

$("#button").click(function(e) {

    var value = $("#cityfield").val();
    $("#dispcity").text(value);
    e.preventDefault();

    var myurl = "https://api.wunderground.com/api/800bea779d1a3fac/geolookup/conditions/q/UT/";
    myurl += value;
    myurl += ".json";
    console.log(myurl);
    
    var weatherInfo = "";
    $.ajax({
        url: myurl,
        dataType: "jsonp",
        success: function(success) {
            console.log(success);

            var loc = success['location']['city'];
            var temp = success['current_observation']['temperature_string'];
            var stat = success['current_observation']['weather'];
            
            weatherInfo += "<ul>";
            weatherInfo += "<li>Location: "+loc;
            weatherInfo += "<li>Temperature:"+temp;
            weatherInfo += "<li>Weather: "+stat;
            weatherInfo += "</ul>";
            $("#weather").html(weatherInfo);
        }
    });
});

$("#cityfield").keyup(function ()
{
    //var url = "https://students.cs.byu.edu/~clement/CS360/ajax/getcity.cgi?q=";
    var url = "jami.space/getcity?q=";
    url += $("#cityfield").val();
    $.getJSON(url,function(success) {
            var everything = "<ul>";
            $.each(success, function(i,item) {
                    everything += "<li> "+success[i].city+"</li>";
                    });
            everything += "</ul>";
            $("#txtHint").html(everything);

            })
    .fail(function(jqXHR, textStatus, errorThrown) {
            console.log("Status"+textStatus);
            console.log("content: "+jqXHR.responseText);
            })
    .done(function() {
            console.log("Done");
            });
});

        </script>

    </body>

</html>
